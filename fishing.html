<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fishing Conditions Chart</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <header class="sticky-header">
        <nav class="nav-container">
            <div class="nav-brand">üèñÔ∏è BeachTime</div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="index.html" class="nav-link">Beach Time</a></li>
                <li class="nav-item"><a href="fishing.html" class="nav-link active">Fishing Time</a></li>
                <li class="nav-item"><button class="nav-button" id="showDataTableBtn">üìä View Data</button></li>
            </ul>
            <div class="weather-source-toggle">
                <label class="weather-source-label">
                    <input type="checkbox" id="useBOMData">
                    <span>Use Bureau of Meteorology Data</span>
                </label>
            </div>
        </nav>
    </header>
    
    <!-- Hamburger Menu Button -->
    <button class="hamburger-menu" id="hamburgerMenu" aria-label="Open controls menu">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
    </button>
    
    <!-- Slide-out Controls Panel -->
    <div class="slide-out-panel" id="slideOutPanel">
        <div class="slide-out-header">
            <h2 class="slide-out-title">‚öôÔ∏è Dataset Controls</h2>
            <button class="close-panel-btn" id="closePanelBtn" aria-label="Close controls menu">&times;</button>
        </div>
        <div class="slide-out-content" id="slideOutContent">
            <!-- Controls will be moved here dynamically -->
        </div>
    </div>
    
    <div class="container">
        <h1>üé£ Fishing Conditions</h1>
        
        <!-- Fishing Animation -->
        <div id="fishing-animation-root" style="height: 400px; margin-bottom: 1rem;"></div>
        
        <!-- Interactive Time Slider -->
        <div class="time-slider-container">
            <div class="time-slider-header">
                <span class="time-slider-label">Time of Day</span>
                <div class="animation-controls">
                    <button class="anim-btn" id="playBtn" title="Play animation">‚ñ∂Ô∏è</button>
                    <button class="anim-btn" id="pauseBtn" title="Pause animation" style="display:none;">‚è∏Ô∏è</button>
                    <button class="anim-btn" id="rewindBtn" title="Rewind to start">‚èÆÔ∏è</button>
                    <label class="anim-checkbox" title="Toggle week/day loop">
                        <input type="checkbox" id="loopModeCheckbox">
                        <span id="loopModeLabel">Day Loop</span>
                    </label>
                    <button class="anim-btn small" id="speedDownBtn" title="Slow down">‚ûñ</button>
                    <span class="speed-display" id="speedDisplay">1x</span>
                    <button class="anim-btn small" id="speedUpBtn" title="Speed up">‚ûï</button>
                </div>
                <span class="time-slider-value" id="timeSliderValue">12:00</span>
            </div>
            <div class="time-slider-track">
                <input type="range" id="timeSlider" min="0" max="24" step="0.5" value="12" class="time-slider-input">
                <div class="time-slider-markers">
                    <span class="time-marker">00:00</span>
                    <span class="time-marker">06:00</span>
                    <span class="time-marker">12:00</span>
                    <span class="time-marker">18:00</span>
                    <span class="time-marker">24:00</span>
                </div>
            </div>
        </div>
        
        <!-- Hidden inputs to store coordinates and timezone -->
        <input type="hidden" id="latitude-fishing" value="-31.9688" />
        <input type="hidden" id="longitude-fishing" value="115.7673" />
        <input type="hidden" id="timezoneSelectFishing" value="Australia/Perth" />
        
        <div class="day-selector" id="globalDaySelectorFishing">
        </div>
        
        <div class="tab-menu" id="chartTabMenuFishing">
            <button class="tab-btn active" data-chart="separated">Separated Rings</button>
            <button class="tab-btn" data-chart="overlaid">Overlaid</button>
            <button class="tab-btn" data-chart="stacked">Stacked</button>
            <button class="tab-btn" data-chart="hourlyRating">Hourly Rating</button>
            <button class="tab-btn" id="weeklyOverviewBtnFishing">Weekly Overview</button>
        </div>
        
        <!-- Location Info Banner (full-width above split layout) -->
        <div class="location-info-banner" id="locationInfoBanner">
            <div class="location-info-text">
                <span class="location-icon">üìç</span>
                <span class="location-name-display" id="locationNameDisplay">Click on map to select location</span>
            </div>
            <div class="location-coords" id="locationCoords">Lat: -31.9688, Lng: 115.7673</div>
        </div>
        
        <!-- Dataset Control Checkboxes (full-width) -->
        <div class="dataset-checkboxes" id="datasetCheckboxes">
            <label class="dataset-checkbox-item">
                <input type="checkbox" id="showPressure" checked>
                <span>Pressure</span>
            </label>
            <label class="dataset-checkbox-item">
                <input type="checkbox" id="showTemperature" checked>
                <span>Temperature</span>
            </label>
            <label class="dataset-checkbox-item">
                <input type="checkbox" id="showWindSpeed" checked>
                <span>Wind Speed</span>
            </label>
            <label class="dataset-checkbox-item">
                <input type="checkbox" id="showCloudCover" checked>
                <span>Cloud Cover</span>
            </label>
            <label class="dataset-checkbox-item">
                <input type="checkbox" id="showRain" checked>
                <span>Rain</span>
            </label>
            <label class="dataset-checkbox-item">
                <input type="checkbox" id="showWaveHeight" checked>
                <span>Wave Height</span>
            </label>
            <label class="dataset-checkbox-item">
                <input type="checkbox" id="showTide" checked>
                <span>Tide</span>
            </label>
            <button class="edit-colors-btn" id="editColorsBtn">üé® Edit Chart Colours</button>
        </div>
        
        <!-- Fishing Map and Chart Container (50/50 split) -->
        <div class="fishing-layout-split">
            <div class="fishing-map-half" id="fishingMapContainer">
                <div id="fishingMap" style="height: 500px; border-radius: 15px;"></div>
            </div>
            
            <div class="fishing-chart-half">
                <div class="chart-container active" id="separatedChartFishing">
                <div class="viz-card">
                    <h2 class="viz-title">Fishing Location</h2>
                    <p class="viz-subtitle" id="chartDateFishing">Loading...</p>
                    
                    <div class="chart-with-dataset-controls">
                        <div class="chart-main-area">
                            <div class="canvas-container">
                                <canvas id="mainCanvasFishing"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
                
                <!-- Additional chart containers will be added similarly -->
                <div class="chart-container" id="overlaidChartFishing">
                    <div class="viz-card">
                        <h2 class="viz-title">Overlaid Comparison</h2>
                        <p class="viz-subtitle" id="chartDateFishing2">Loading...</p>
                        
                        <div class="chart-with-dataset-controls">
                            <div class="chart-main-area">
                                <div class="canvas-container">
                                    <canvas id="overlayCanvasFishing"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container" id="stackedChartFishing">
                    <div class="viz-card">
                        <h2 class="viz-title">Stacked View</h2>
                        <p class="viz-subtitle" id="chartDateFishing3">Loading...</p>
                        
                        <div class="chart-with-dataset-controls">
                            <div class="chart-main-area">
                                <div class="canvas-container">
                                    <canvas id="stackedCanvasFishing"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container" id="hourlyRatingChartFishing">
                    <div class="viz-card">
                        <h2 class="viz-title">Hourly Rating</h2>
                        <p class="viz-subtitle" id="chartDateFishing4">Loading...</p>
                        
                        <div class="chart-with-dataset-controls">
                            <div class="chart-main-area">
                                <div class="canvas-container">
                                    <canvas id="hourlyRatingCanvasFishing"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container" id="weeklyOverviewChartFishing">
                    <div class="viz-card">
                        <h2 class="viz-title">Weekly Overview</h2>
                        <p class="viz-subtitle">Daily normalized ratings for the week</p>
                        
                        <div class="chart-with-dataset-controls">
                            <div class="chart-main-area">
                                <div class="canvas-container">
                                    <canvas id="weeklyOverviewCanvasFishing"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Dataset Controls (for slide-out panel only) -->
        <div class="right-side-controls" id="fishingDatasetControls">
            <div class="controls-section-title">‚öôÔ∏è Fishing Dataset Controls</div>
            
            <div class="slider-section">
                <div class="slider-section-header">üé£ Fishing Ideal Ranges</div>
                
                <div class="range-slider-item">
                    <div class="range-slider-label">
                        <span>üîµ Pressure (hPa)</span>
                    </div>
                    <div class="range-inputs-vertical">
                        <div class="range-input-group">
                            <span class="range-input-label">Min</span>
                            <input type="range" class="range-slider-small" id="fishPressureMinRange" min="900" max="1050" step="1" value="980">
                            <span class="range-value-display" id="fishPressureMinValue">980 hPa</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Ideal Min</span>
                            <input type="range" class="range-slider-small" id="fishPressureIdealMinRange" min="900" max="1050" step="1" value="1010">
                            <span class="range-value-display" id="fishPressureIdealMinValue">1010 hPa</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Ideal Max</span>
                            <input type="range" class="range-slider-small" id="fishPressureIdealMaxRange" min="900" max="1050" step="1" value="1020">
                            <span class="range-value-display" id="fishPressureIdealMaxValue">1020 hPa</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Max</span>
                            <input type="range" class="range-slider-small" id="fishPressureMaxRange" min="900" max="1050" step="1" value="1040">
                            <span class="range-value-display" id="fishPressureMaxValue">1040 hPa</span>
                        </div>
                    </div>
                </div>
                
                <div class="range-slider-item">
                    <div class="range-slider-label">
                        <span>üå°Ô∏è Temperature (¬∞C)</span>
                    </div>
                    <div class="range-inputs-vertical">
                        <div class="range-input-group">
                            <span class="range-input-label">Min</span>
                            <input type="range" class="range-slider-small" id="fishTempMinRange" min="0" max="50" step="1" value="10">
                            <span class="range-value-display" id="fishTempMinValue">10¬∞C</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Ideal Min</span>
                            <input type="range" class="range-slider-small" id="fishTempIdealMinRange" min="0" max="50" step="1" value="15">
                            <span class="range-value-display" id="fishTempIdealMinValue">15¬∞C</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Ideal Max</span>
                            <input type="range" class="range-slider-small" id="fishTempIdealMaxRange" min="0" max="50" step="1" value="25">
                            <span class="range-value-display" id="fishTempIdealMaxValue">25¬∞C</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Max</span>
                            <input type="range" class="range-slider-small" id="fishTempMaxRange" min="0" max="50" step="1" value="35">
                            <span class="range-value-display" id="fishTempMaxValue">35¬∞C</span>
                        </div>
                    </div>
                </div>
                
                <div class="range-slider-item">
                    <div class="range-slider-label">
                        <span>üí® Wind Speed (km/h)</span>
                    </div>
                    <div class="range-inputs-vertical">
                        <div class="range-input-group">
                            <span class="range-input-label">Min</span>
                            <input type="range" class="range-slider-small" id="fishWindMinRange" min="0" max="50" step="1" value="0">
                            <span class="range-value-display" id="fishWindMinValue">0 km/h</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Ideal Min</span>
                            <input type="range" class="range-slider-small" id="fishWindIdealMinRange" min="0" max="50" step="1" value="0">
                            <span class="range-value-display" id="fishWindIdealMinValue">0 km/h</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Ideal Max</span>
                            <input type="range" class="range-slider-small" id="fishWindIdealMaxRange" min="0" max="50" step="1" value="15">
                            <span class="range-value-display" id="fishWindIdealMaxValue">15 km/h</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Max</span>
                            <input type="range" class="range-slider-small" id="fishWindMaxRange" min="0" max="50" step="1" value="40">
                            <span class="range-value-display" id="fishWindMaxValue">40 km/h</span>
                        </div>
                    </div>
                </div>
                
                <div class="range-slider-item">
                    <div class="range-slider-label">
                        <span>‚òÅÔ∏è Cloud Cover (%)</span>
                    </div>
                    <div class="range-inputs-vertical">
                        <div class="range-input-group">
                            <span class="range-input-label">Min (Best)</span>
                            <input type="range" class="range-slider-small" id="fishCloudMinRange" min="0" max="100" step="5" value="0">
                            <span class="range-value-display" id="fishCloudMinValue">0%</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Max (Worst)</span>
                            <input type="range" class="range-slider-small" id="fishCloudMaxRange" min="0" max="100" step="5" value="100">
                            <span class="range-value-display" id="fishCloudMaxValue">100%</span>
                        </div>
                    </div>
                </div>
                
                <div class="range-slider-item">
                    <div class="range-slider-label">
                        <span>üåä Wave Height (m)</span>
                    </div>
                    <div class="range-inputs-vertical">
                        <div class="range-input-group">
                            <span class="range-input-label">Min</span>
                            <input type="range" class="range-slider-small" id="fishWaveMinRange" min="0" max="10" step="0.5" value="0">
                            <span class="range-value-display" id="fishWaveMinValue">0m</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Ideal Min</span>
                            <input type="range" class="range-slider-small" id="fishWaveIdealMinRange" min="0" max="10" step="0.5" value="0">
                            <span class="range-value-display" id="fishWaveIdealMinValue">0m</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Ideal Max</span>
                            <input type="range" class="range-slider-small" id="fishWaveIdealMaxRange" min="0" max="10" step="0.5" value="1.5">
                            <span class="range-value-display" id="fishWaveIdealMaxValue">1.5m</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Max</span>
                            <input type="range" class="range-slider-small" id="fishWaveMaxRange" min="0" max="10" step="0.5" value="5">
                            <span class="range-value-display" id="fishWaveMaxValue">5m</span>
                        </div>
                    </div>
                </div>
                
                <div class="range-slider-item">
                    <div class="range-slider-label">
                        <span>üåä Tide Height (%)</span>
                    </div>
                    <div class="range-inputs-vertical">
                        <div class="range-input-group">
                            <span class="range-input-label">Min</span>
                            <input type="range" class="range-slider-small" id="fishTideMinRange" min="0" max="100" step="5" value="0">
                            <span class="range-value-display" id="fishTideMinValue">0%</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Ideal Min</span>
                            <input type="range" class="range-slider-small" id="fishTideIdealMinRange" min="0" max="100" step="5" value="30">
                            <span class="range-value-display" id="fishTideIdealMinValue">30%</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Ideal Max</span>
                            <input type="range" class="range-slider-small" id="fishTideIdealMaxRange" min="0" max="100" step="5" value="70">
                            <span class="range-value-display" id="fishTideIdealMaxValue">70%</span>
                        </div>
                        <div class="range-input-group">
                            <span class="range-input-label">Max</span>
                            <input type="range" class="range-slider-small" id="fishTideMaxRange" min="0" max="100" step="5" value="100">
                            <span class="range-value-display" id="fishTideMaxValue">100%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Full-width sections after the split layout -->
        <div class="data-timeline">
            <div class="timeline-title">Hourly Data</div>
            <div class="timeline-container" id="timelineFishing1"></div>
        </div>
        
        <div class="location-label">
            <div class="location-name">Fishing Location</div>
            <div class="location-date" id="currentDateFishing">Loading...</div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #667eea;"></div>
                <span><strong>Pressure</strong> (ideal: 1010-1020 hPa)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #F28C28;"></div>
                <span><strong>Temperature</strong> (ideal: 15-25¬∞C)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #32dbae;"></div>
                <span><strong>Wind Speed</strong> (ideal: 0-15 km/h)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #c1cad9;"></div>
                <span><strong>Cloud Cover</strong> (less is better)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #7993e8;"></div>
                <span><strong>Rain</strong> (background)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #0080ff;"></div>
                <span><strong>Wave Height</strong> (ideal: 0-1.5m)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #ff0080;"></div>
                <span><strong>Tide Level</strong> (varies)</span>
            </div>
        </div>
        
        <!-- Fish Species Table with Enhanced Marine Database -->
        <div class="fish-table-container" id="fishTableContainer">
            <h2 class="section-title">üêü Marine Species Database</h2>
            <p class="section-subtitle">Fish species commonly found at this location</p>
            <div id="fishSpeciesTable" class="fish-species-table">
                <p>Select a location on the map to view local fish species...</p>
            </div>
        </div>
        
        <!-- Data Table Modal -->
        <div class="modal-overlay" id="dataTableModal" style="display: none;">
            <div class="modal-content" style="max-width: 90%; max-height: 90vh; overflow: auto;">
                <div class="modal-header">
                    <h2 class="modal-title">üìä Weather Data Table</h2>
                    <button class="close-btn" id="closeDataTableModal">&times;</button>
                </div>
                <div id="dataTableContent" style="overflow-x: auto; padding: 20px;">
                    <!-- Data table will be inserted here -->
                </div>
            </div>
        </div>
        
        <!-- Color Editor Modal -->
        <div class="modal-overlay" id="colorEditorModal" style="display: none;">
            <div class="modal-content" style="max-width: 600px;">
                <div class="modal-header">
                    <h2 class="modal-title">üé® Edit Chart Colours</h2>
                    <button class="close-btn" id="closeColorEditorModal">&times;</button>
                </div>
                <div class="color-editor-content">
                    <p style="margin-bottom: 15px;">Customize the chart colors for each dataset. Changes will be saved automatically.</p>
                    <div id="colorPickersContainer"></div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="edit-colors-btn" id="resetColorsBtn">Reset to Default</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- How to Read Chart Info Box -->
        <div class="info-box">
            <div class="info-title">How to Read This Chart</div>
            <div class="info-text">
                The chart flows clockwise from 7am (left) through 12pm-1pm (top) to 7pm (right) in a semi-circle arc. 
                Each colored ring represents a different metric in its own range. Pressure (innermost), Temperature, Wind Speed, Cloud Cover (inverted), and Wave Height (outermost).
                Rain probability is shown as a water droplet pattern in the background of each hour segment.
                Higher values within each ring indicate better scores (closer to ideal conditions). 
                Time labels and detailed readings appear around the outside of the chart.
            </div>
        </div>
    </div>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="tide-harmonic.js"></script>
    <script src="tide-csv-loader.js"></script>
    <script src="marine-species.js"></script>
    <script src="fishing-animation.js"></script>
    <script src="script.js"></script>
    <script src="fishing-script.js"></script>
    <script>
        // Initialize fishing animation after page loads
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof initFishingAnimation === 'function') {
                // Delay animation initialization to ensure all dependencies are loaded
                setTimeout(initFishingAnimation, 500);
            }
            
            // Initialize time slider
            initTimeSlider();
            
            // Initialize dataset checkboxes
            initDatasetCheckboxes();
        });
    </script>
</body>
</html>
